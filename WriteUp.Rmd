---
title: "Linear Model with Prediction"
author: "Ezra Licciardi"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`"    
---


```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(knitr)
require(foreign)
```

```{r, eval=TRUE, warning=FALSE}
url <- "https://onlinestatbook.com/case_studies_rvls/physical_strength/data.txt"
mydata <- read.csv(file=url,sep="",header=TRUE)  
```

# Introduction

We are looking at data procured from RVLS regarding "Physical Strength and Job Performance". We are exploring this data to see if any statistically significant correlations exist in the data or if the data is meaningfully related.

$H_0$ There are no statistically meaningful relation in the data.

$H_A$ There are statistically meaningful relation in the data.


# Methods

```{r}
glimpse(mydata)
model1 <- lm(SIMS~ARM,data=mydata)
model2 <- lm(SIMS~GRIP,data=mydata)
model3 <- lm(SIMS~ARM+GRIP,data=mydata)
```

Looking at the data provided they are all of data type: double meaning that they are continuous numerical data. This means that all problems in this write up will be of the numerical~numerical type.

With the CandP helper file we will use scatter plots, correlation coefficients, and linear regression to explore the data.

# Results

## Graphical Results

### Target and Predict
```{r}
target <- data.frame(ARM=88,GRIP=44)
predict(model1,target,interval=c("prediction"))
```

``` {r include = TRUE, echo = FALSE}
yVarARM <- round(coef(lm(SIMS ~ ARM, data = mydata)), 3)[2]
xVarARM <- round(coef(lm(SIMS ~ ARM, data = mydata)), 1)[1]

yVarGRIP <- round(coef(lm(SIMS ~ GRIP, data = mydata)), 3)[2]
xVarGRIP <- round(coef(lm(SIMS ~ GRIP, data = mydata)), 1)[1]

yVarBOTH <- round(coef(lm(SIMS ~ ARM+GRIP, data = mydata)), 3)[2]
xVarBOTH <- round(coef(lm(SIMS ~ ARM+GRIP, data = mydata)), 1)[1]

ggplot(mydata, aes(x = ARM, y = SIMS)) +
  geom_point() +
  labs(title = "SIMS ~ ARM",x = "ARM",y = "SIMS") + 
  theme(plot.title = element_text(hjust = 0.5, size = 20)) +
  geom_smooth(method=lm) + 
  geom_label(aes(x = 65, y = 3, label = paste("y = ", yVarARM, "x + ", xVarARM) ))


ggplot(mydata, aes(x = GRIP, y = SIMS)) +
  geom_point() +
  labs(title = "SIMS ~ GRIP",x = "GRIP",y = "SIMS") + 
  theme(plot.title = element_text(hjust = 0.5, size = 20)) +
  geom_smooth(method=lm) + 
  geom_label(aes(x = 75, y = 1.5, label = paste("y = ", yVarGRIP, "x + ", xVarGRIP) ))

ggplot(mydata, aes(x = ARM+GRIP, y = SIMS)) +
  geom_point() +
  labs(title = "SIMS ~ ARM + GRIP",x = "ARM + GRIP",y = "SIMS") + 
  theme(plot.title = element_text(hjust = 0.5, size = 20)) +
  geom_smooth(method=lm) + 
  geom_label(aes(x = 150, y = 2.5, label = paste("y = ", yVarBOTH, "x + ", xVarBOTH) ))
```



## Numerical Results

```{r}
print("AMR")
cor(SIMS~ARM,data=mydata)
print("____________")
print("GRIP")
cor(SIMS~GRIP,data=mydata)
print("____________")
print("ARM + GRIP")
cor(SIMS~ARM+GRIP,data=mydata)
```

## Inferential Results

```{r}
summary.lm(model1)
print("----------------")
summary.lm(model2)
print("----------------")
summary.lm(model3)
print("----------------")
anova(model1,model2,model3)
```

# Conclusion and Discussion